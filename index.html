<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Interativo</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="quiz-container">
    <h1>Quiz Bíblico</h1>
    <div id="quiz"></div>
    <button id="submit">Enviar Respostas</button>
    <div id="results"></div>
  </div>

  <script>
    const quizQuestions = [
      {
        question: "Quem construiu a arca?",
        answers: {
          a: "Moisés",
          b: "Noé",
          c: "Abraão"
        },
        correctAnswer: "b"
      },
      {
        question: "Qual foi o primeiro homem criado por Deus?",
        answers: {
          a: "Adão",
          b: "Davi",
          c: "Pedro"
        },
        correctAnswer: "a"
      }
    ];

    function buildQuiz() {
      const output = [];
      quizQuestions.forEach((currentQuestion, questionNumber) => {
        const answers = [];
        for (letter in currentQuestion.answers) {
          answers.push(
            `<label>
              <input type="radio" name="question${questionNumber}" value="${letter}">
              ${letter}: ${currentQuestion.answers[letter]}
            </label>`
          );
        }
        output.push(
          `<div class="question"> ${currentQuestion.question} </div>
          <div class="answers"> ${answers.join("")} </div>`
        );
      });
      document.getElementById("quiz").innerHTML = output.join("");
    }

    function showResults() {
      const answerContainers = quizContainer.querySelectorAll(".answers");
      let numCorrect = 0;
      const answersArray = [];

      quizQuestions.forEach((currentQuestion, questionNumber) => {
        const answerContainer = answerContainers[questionNumber];
        const selector = `input[name=question${questionNumber}]:checked`;
        const userAnswer = (answerContainer.querySelector(selector) || {}).value;

        if (userAnswer === currentQuestion.correctAnswer) {
          numCorrect++;
        }

        answersArray.push({
          question: currentQuestion.question,
          selected: userAnswer || "Não respondeu",
          correct: currentQuestion.correctAnswer
        });
      });

      resultsContainer.innerHTML = `${numCorrect} de ${quizQuestions.length} corretas`;

      // Pergunta o nome antes de enviar
      const name = prompt("Digite seu nome:");

      const payload = {
        name: name,
        score: numCorrect,
        total: quizQuestions.length,
        answers: answersArray
      };

      fetch("https://script.google.com/macros/s/AKfycbyiPSe_-TnyHWy0LXtJSde3RzW2cosX6UiILq6TfDDiFTg_xTVLqKPXvtyMVQdG3wSA/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      })
      .then(res => res.json())
      .then(data => {
        if (data.status === "success") {
          alert("Respostas enviadas com sucesso!");
        } else {
          alert("Erro ao enviar respostas: " + data.message);
        }
      })
      .catch(err => {
        alert("Erro ao enviar respostas: " + err);
      });
    }

    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const submitButton = document.getElementById("submit");

    buildQuiz();
    submitButton.addEventListener("click", showResults);
  </script>
</body>
</html>
